<html>
  <head>
    <title>Text to Emoji Translator</title>
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
    <script src="firebase-as-array.js"></script>
  </head>
  <body>
    <h1>Emoji Translator!</h1>
    <fieldset>
      <legend>Text to Translate:</legend>
      <form NAME="myform">
	       <INPUT TYPE="text" NAME="text" VALUE=""/>
	       <br>
	       <input type="button" name="button" value="Go!" onClick="printCaps()"/>
      </form>
    </fieldset>
    <fieldset>
      <legend>Translation:</legend>
    </fieldset>
    <div id='messagesDiv'></div>
    <input type='text' id='emojicode' placeholder='Unicode'>
    <input type='text' id='annotation' placeholder='Annotation'>

</body>
  <script>
    var myDataRef = new Firebase('https://popping-heat-9713.firebaseio.com/');
    var textDict = {}
    //$('#annotation').keypress(function (e) {
    //    if (e.keyCode == 13) {
    //      var name = $('#annotation').val();
    //      var text = $('#emojicode').val();
     //     myDataRef.push({name: name, text: text});
     //     $('#annotation').val('');
     //   }
      //});
    myDataRef.on("value", function(snapshot) {
      console.log(snapshot.val());
      textDict = snapshot.val()
      });
    function printCaps()
          {
             var textstr = document.myform.text.value;
             var res = textstr.split(" ");
             console.log(res)
             var translate = []
             var tempList = []
             for (var word in res) 
             {
              console.log(res[word])
                found = false
                for (var key in textDict)
                  tempList = textDict[key]
                  for (var value in textDict[key])
                    console.log(tempList[value])
                    console.log("sep")
                    console.log(res[word])
                    if (res[word] === tempList[value])
                    { 
                      translate.push(res[word])
                      translate.push("U+" + key) //append key
                      found = true
                      break
                    }
                    if (!found)
                    {
                      translate.push(res[word])
                    }
             }
             console.log(translate)
             document.getElementById('result').value = translate;
          }

  </script>

</html>
